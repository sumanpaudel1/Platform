{% extends 'products/base.html' %}

{% block content %}
<!-- Toast Notification System -->
<div id="notification-container" class="fixed top-10 right-6 z-50 flex flex-col gap-3 items-end"></div>

<!-- Enhanced Hero Section with Advanced Animations and Improved Slider -->
<section class="relative h-[90vh] overflow-hidden">
    <!-- Dynamic Background with Animated Overlay -->
    <div class="absolute inset-0">
        {% for cover in cover_photos %}
        <div class="absolute inset-0 transition-all duration-1500 ease-in-out {% if forloop.first %}opacity-100{% else %}opacity-0{% endif %}"
            data-cover="{{ forloop.counter0 }}">
            <div class="absolute inset-0 bg-black/40 mix-blend-multiply"></div>
            <img src="{{ cover.image.url }}" 
                 class="w-full h-full object-cover animate-ken-burns" 
                 alt="{{ vendor.settings.store_name }}">
            
            <!-- Enhanced Gradient Overlay -->
            <div class="absolute inset-0 bg-gradient-to-r from-black/90 via-black/70 to-transparent"></div>
        </div>
        {% endfor %}
        
        <!-- Improved Abstract Shapes for Visual Interest -->
        <div class="absolute inset-0 overflow-hidden pointer-events-none">
            <div class="absolute top-1/4 left-1/4 w-40 h-40 rounded-full border-4 border-white/10 animate-float-slow"></div>
            <div class="absolute bottom-1/3 right-1/5 w-56 h-56 rounded-full border border-white/20 animate-float-medium" style="animation-delay: 2s"></div>
            <div class="absolute top-1/2 left-2/3 w-32 h-32 rounded-full bg-white/5 backdrop-blur-md animate-pulse-slow"></div>
            <div class="absolute bottom-1/4 left-1/3 w-24 h-24 rounded-full border-2 border-white/15 animate-float-fast" style="animation-delay: 1s"></div>
        </div>
    </div>

    <!-- Enhanced Content with Animated Entrance -->
    <div class="container mx-auto px-6 h-full flex items-center relative z-10">
        <div class="max-w-xl">
            <div class="mb-6 animate-fade-right" style="animation-delay: 300ms">
                <span class="inline-block px-4 py-2 bg-white/10 backdrop-blur-sm border border-white/20 rounded-full text-white text-sm">
                    Welcome to Our Collection
                </span>
            </div>
            
            <h1 class="text-5xl md:text-6xl font-bold text-white leading-tight mb-6 animate-fade-right" style="animation-delay: 500ms">
                {{ vendor.settings.store_name }}
            </h1>
            
            {% if vendor.settings.tagline %}
            <p class="text-xl text-white/90 mb-8 animate-fade-right" style="animation-delay: 700ms">
                {{ vendor.settings.tagline }}
            </p>
            {% endif %}
            
            <div class="flex flex-wrap gap-4 animate-fade-right" style="animation-delay: 900ms">
                <a href="#featured" 
                   class="group px-8 py-3.5 bg-white text-gray-900 rounded-lg hover:bg-[var(--primary)] hover:text-white transition-all duration-300 flex items-center">
                    <span>Explore Collection</span>
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 ml-2 transition-transform duration-300 group-hover:translate-x-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3" />
                    </svg>
                </a>
                
                <a href="#about" 
                   class="px-8 py-3.5 border-2 border-white bg-transparent text-white hover:bg-white hover:text-gray-900 rounded-lg transition-colors duration-300">
                    Learn More
                </a>
            </div>
        </div>
    </div>

    <!-- Enhanced Slide Indicators -->
    <div class="absolute bottom-10 left-1/2 transform -translate-x-1/2 flex space-x-2 z-20">
        {% for cover in cover_photos %}
        <button 
            class="w-3 h-3 rounded-full transition-all duration-300 {% if forloop.first %}bg-white w-10{% else %}bg-white/40{% endif %}" 
            data-slide="{{ forloop.counter0 }}"
            aria-label="Go to slide {{ forloop.counter }}">
        </button>
        {% endfor %}
    </div>

    <!-- Animated Scroll Indicator -->
    <div class="absolute bottom-10 left-1/2 transform -translate-x-1/2 animate-bounce">
        <a href="#categories" class="text-white/80 hover:text-white transition-colors">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 14l-7 7m0 0l-7-7m7 7V3" />
            </svg>
        </a>
    </div>
</section>

<!-- Enhanced Stats Bar with Animations -->
<section class="bg-white py-6 border-b border-gray-100">
    <div class="container mx-auto px-6">
        <div class="flex flex-wrap justify-around">
            <div class="flex items-center gap-3 px-6 py-2 hover:-translate-y-1 transition-transform duration-300">
                <div class="w-10 h-10 rounded-full bg-[var(--primary)]/10 flex items-center justify-center">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-[var(--primary)]" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                    </svg>
                </div>
                <span class="text-gray-700">Quality Products</span>
            </div>
            <div class="flex items-center gap-3 px-6 py-2 hover:-translate-y-1 transition-transform duration-300">
                <div class="w-10 h-10 rounded-full bg-[var(--primary)]/10 flex items-center justify-center">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-[var(--primary)]" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                    </svg>
                </div>
                <span class="text-gray-700">Fast Delivery</span>
            </div>
            <div class="flex items-center gap-3 px-6 py-2 hover:-translate-y-1 transition-transform duration-300">
                <div class="w-10 h-10 rounded-full bg-[var(--primary)]/10 flex items-center justify-center">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-[var(--primary)]" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" />
                    </svg>
                </div>
                <span class="text-gray-700">Secure Payments</span>
            </div>
            <div class="flex items-center gap-3 px-6 py-2 hover:-translate-y-1 transition-transform duration-300">
                <div class="w-10 h-10 rounded-full bg-[var(--primary)]/10 flex items-center justify-center">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-[var(--primary)]" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z" />
                    </svg>
                </div>
                <span class="text-gray-700">24/7 Support</span>
            </div>
        </div>
    </div>
</section>

<!-- Enhanced Categories Section with Modern Cards and Animations -->
<section id="categories" class="py-20 bg-gray-50">
    <div class="container mx-auto px-6">
        <div class="text-center mb-14 relative animate-on-scroll">
            <span class="inline-block text-[var(--accent)] font-semibold text-sm uppercase tracking-wider mb-2">Explore</span>
            <h2 class="text-4xl font-bold relative inline-block">
                Shop by Category
                <span class="absolute -bottom-3 left-1/2 transform -translate-x-1/2 w-24 h-1.5 bg-[var(--primary)]"></span>
            </h2>
        </div>
        
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-8">
            {% for category in categories %}
            <a href="{% url 'products:product_list' subdomain=vendor.subdomain %}?category={{ category.id }}" 
               class="group cursor-pointer h-[320px] rounded-2xl overflow-hidden shadow-lg hover:shadow-xl transition-all duration-500 relative animate-on-scroll" 
               style="animation-delay: {{ forloop.counter0 }}00ms">
                {% if category.category_image %}
                <img src="{{ category.category_image.url }}" 
                     alt="{{ category.category_name }}"
                     class="w-full h-full object-cover transform group-hover:scale-110 transition-transform duration-700">
                
                <!-- Enhanced overlay with gradient -->
                <div class="absolute inset-0 bg-gradient-to-t from-black/90 via-black/50 to-transparent transition-opacity duration-300"></div>
                
                <!-- Category content with improved animations -->
                <div class="absolute inset-x-0 bottom-0 p-6 translate-y-2 opacity-90 group-hover:translate-y-0 group-hover:opacity-100 transition-all duration-300">
                    <h3 class="text-2xl font-bold text-white mb-2">{{ category.category_name }}</h3>
                    <div class="flex items-center text-white/80">
                        <span>Browse Products</span>
                        <i class="fas fa-arrow-right ml-2 transform group-hover:translate-x-2 transition-transform"></i>
                    </div>
                </div>
                {% endif %}
            </a>
            {% endfor %}
        </div>
        
        <!-- Add Browse All Categories button -->
        <div class="text-center mt-12">
            <a href="{% url 'products:product_list' subdomain=vendor.subdomain %}" 
               class="inline-flex items-center gap-3 px-8 py-3 bg-[var(--primary)] text-white rounded-lg hover:bg-opacity-90 transition-all shadow-lg hover:shadow-[var(--primary)]/20">
                <span>Browse All Products</span>
                <i class="fas fa-arrow-right"></i>
            </a>
        </div>
    </div>
</section>





<!-- Personalized Recommendations Section -->
<section class="py-8 md:py-12">
    <div class="flex justify-between items-center mb-6">
        <h2 class="text-2xl font-bold">Recommended For You</h2>
        <a href="{% url 'products:product_list' subdomain=vendor.subdomain %}" class="text-[var(--primary)] hover:underline">
            View all &rarr;
        </a>
    </div>
    
    <div id="recommendedProducts" class="grid grid-cols-2 md:grid-cols-4 gap-4">
        {% if recommended_products %}
            {% for product in recommended_products %}
                <div class="bg-white rounded-lg shadow-sm overflow-hidden hover:shadow-md transition-all">
                    <a href="{% url 'products:product_detail' subdomain=vendor.subdomain slug=product.slug %}">
                        {% if product.product_images.first %}
                            <img src="{{ product.product_images.first.image.url }}" 
                                 alt="{{ product.name }}" 
                                 class="w-full h-48 object-cover">
                        {% else %}
                            <div class="w-full h-48 bg-gray-200 flex items-center justify-center">
                                <span class="text-gray-400">No image</span>
                            </div>
                        {% endif %}
                        
                        <div class="p-4">
                            <h3 class="text-sm font-medium text-gray-900 truncate">{{ product.name }}</h3>
                            <p class="mt-1 text-lg font-semibold text-[var(--primary)]">NPR {{ product.price }}</p>
                            {% if product.similarity_score %}
                                <div class="mt-1 flex items-center">
                                    <span class="text-xs bg-blue-50 text-blue-700 px-2 py-0.5 rounded-full">
                                        {{ product.similarity_score|floatformat:0 }}% match
                                    </span>
                                    {% if product.category %}
                                        <span class="ml-2 text-xs text-gray-500">{{ product.category.category_name }}</span>
                                    {% endif %}
                                </div>
                            {% endif %}
                        </div>
                    </a>
                </div>
            {% endfor %}
        {% else %}
            <p class="col-span-4 text-center py-4 text-gray-500">No recommended products available</p>
        {% endif %}
    </div>
</section>





<!-- Enhanced Featured Products With Modern UI and Animations -->
<section id="featured" class="py-20 bg-white">
    <div class="container mx-auto px-6">
        <div class="text-center mb-14 relative animate-on-scroll">
            <span class="inline-block text-[var(--primary)] font-semibold text-sm uppercase tracking-wider mb-2">Discover</span>
            <h2 class="text-4xl font-bold relative inline-block">
                Featured Products
                <span class="absolute -bottom-3 left-1/2 transform -translate-x-1/2 w-24 h-1.5 bg-[var(--accent)]"></span>
            </h2>
        </div>
        
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-8">
            {% for product in products %}
            <div class="bg-white rounded-xl overflow-hidden group transition-all duration-300 hover:shadow-xl animate-on-scroll {% if product.stock <= 0 %}opacity-80{% endif %}"
                 style="animation-delay: {{ forloop.counter0 }}00ms">
                <div class="relative">
                    <a href="{% if product.stock > 0 %}{% url 'products:product_detail' subdomain=vendor.subdomain.subdomain slug=product.slug %}{% else %}javascript:void(0){% endif %}"
                       {% if product.stock <= 0 %}onclick="showNotification('Sorry, {{ product.name }} is currently out of stock', 'error'); return false;"{% endif %}
                       class="block {% if product.stock <= 0 %}cursor-not-allowed{% endif %}">
                        
                        <div class="relative aspect-square overflow-hidden bg-gray-100">
                            {% if product.product_images.first %}
                                <img src="{{ product.product_images.first.image.url }}" 
                                    class="w-full h-full object-cover transition-transform duration-500 {% if product.stock > 0 %}group-hover:scale-110{% endif %}"
                                    alt="{{ product.name }}">
                            {% else %}
                                <div class="w-full h-full flex items-center justify-center text-gray-400">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-16 w-16" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" />
                                    </svg>
                                </div>
                            {% endif %}
                            
                            {% if product.cut_price %}
                                <div class="absolute top-3 left-3 bg-red-500 text-white text-xs font-medium px-2.5 py-1 rounded-md">
                                    {{ product.discount_percentage|floatformat:0 }}% OFF
                                </div>
                            {% endif %}
                            
                            <!-- Enhanced stock indicators -->
                            {% if product.stock <= 0 %}
                                <div class="absolute inset-0 bg-black/50 backdrop-blur-[2px] flex items-center justify-center">
                                    <span class="bg-red-500 text-white px-4 py-2 rounded-md font-medium text-sm">
                                        Out of Stock
                                    </span>
                                </div>
                            {% elif product.stock <= 5 %}
                                <div class="absolute top-3 right-3">
                                    <span class="bg-amber-500 text-white text-xs font-medium px-2.5 py-1 rounded-md">
                                        Only {{ product.stock }} left
                                    </span>
                                </div>
                            {% endif %}
                        </div>
                    </a>
                    
                    <!-- Enhanced wishlist button with modern style -->
                    <button onclick="toggleWishlist({{ product.id }}); event.preventDefault();"
                            class="absolute top-3 right-3 w-9 h-9 bg-white/70 backdrop-blur-sm rounded-full shadow-sm 
                                   flex items-center justify-center transition-all duration-300 
                                   hover:bg-[var(--primary)] hover:text-white wishlist-btn z-10
                                   {% if product.stock <= 0 %}opacity-0{% endif %}"
                            data-product-id="{{ product.id }}">
                        <i class="{% if product.id in wishlisted_products %}fas{% else %}far{% endif %} fa-heart"></i>
                    </button>
                </div>
                
                <div class="p-5">
                    <div class="mb-3">
                        <h3 class="font-medium text-lg leading-snug line-clamp-1">{{ product.name }}</h3>
                        <div class="flex justify-between items-center mt-1.5">
                            <div class="flex items-end gap-2">
                                <span class="text-lg font-bold text-[var(--primary)]">
                                    ${{ product.price }}
                                </span>
                                {% if product.cut_price %}
                                    <span class="text-sm text-gray-400 line-through">
                                        ${{ product.cut_price }}
                                    </span>
                                {% endif %}
                            </div>
                            
                            <!-- Star Rating -->
                            <div class="flex text-amber-400 text-sm">
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star-half-alt"></i>
                            </div>
                        </div>
                    </div>
                    
                    <button 
                        {% if product.stock <= 0 %}
                            disabled
                            onclick="showNotification('{{ product.name }} is currently out of stock', 'error')"
                            class="w-full mt-3 bg-gray-200 text-gray-500 py-2.5 rounded-lg cursor-not-allowed flex items-center justify-center"
                        {% else %}
                            onclick="addToCart({{ product.id }})"
                            class="w-full mt-3 bg-[var(--primary)] text-white py-2.5 rounded-lg
                                   transition-all duration-300 hover:shadow-md hover:bg-[var(--primary-darker)] hover:text-zinc-700 
                                   active:scale-95 add-to-cart flex items-center justify-center"
                        {% endif %}
                        data-product-id="{{ product.id }}"
                        data-stock="{{ product.stock }}">
                        {% if product.stock > 0 %}
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z" />
                            </svg>
                            Add to Cart
                        {% else %}
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
                            </svg>
                            Out of Stock
                        {% endif %}
                    </button>
                </div>
            </div>
            {% endfor %}
        </div>
        
        <!-- Enhanced View All Products Button with Modern Styling -->
        <div class="text-center mt-14 animate-on-scroll">
            <a href="{% url 'products:product_list' subdomain=vendor.subdomain %}" 
               class="group inline-flex items-center gap-2 px-8 py-3 border border-[var(--primary)] text-[var(--primary)] rounded-lg 
                      hover:bg-[var(--primary)] hover:text-white transition-all duration-300">
                <span>Browse All Products</span>
                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 transition-transform duration-300 group-hover:translate-x-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3" />
                </svg>
            </a>
        </div>
    </div>
</section>

<!-- Enhanced Trending Collection Banner with Parallax Effect -->
<section class="py-14 bg-gray-50 overflow-hidden">
    <div class="container mx-auto px-6">
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            <!-- Left: Image with Parallax -->
            <div class="relative overflow-hidden rounded-2xl parallax-container animate-on-scroll">
                {% with trending_image=cover_photos.first %}
                {% if trending_image %}
                <img src="{{ trending_image.image.url }}" class="w-full h-96 object-cover parallax-bg" alt="Trending collection">
                {% endif %}
                {% endwith %}
                <div class="absolute inset-0 bg-gradient-to-r from-black/80 to-transparent flex items-center">
                    <div class="p-10">
                        <h3 class="text-3xl font-bold text-white mb-4">New Season Arrivals</h3>
                        <p class="text-white/80 mb-6">Discover our latest collection of seasonal products</p>
                        <a href="?category=new-arrivals" class="inline-flex items-center bg-white text-gray-900 px-6 py-3 rounded-lg hover:bg-[var(--primary)] hover:text-white transition-colors duration-300">
                            Explore Collection
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 ml-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
                            </svg>
                        </a>
                    </div>
                </div>
            </div>
            
            <!-- Right: New Arrivals with Staggered Animation -->
            <div class="grid grid-cols-1 sm:grid-cols-2 gap-6 stagger-children">
                {% for product in new_arrivals|slice:":2" %}
                <div class="flex bg-white rounded-xl overflow-hidden shadow-sm hover:shadow-md transition-all duration-300">
                    <!-- Product Image -->
                    <div class="w-1/3 relative">
                        {% if product.product_images.first %}
                        <img src="{{ product.product_images.first.image.url }}" 
                             class="w-full h-full object-cover" 
                             alt="{{ product.name }}">
                        {% endif %}
                        
                        {% if product.stock <= 0 %}
                        <div class="absolute inset-0 bg-black/50 flex items-center justify-center">
                            <span class="bg-red-500 text-white px-2 py-1 text-xs rounded">Out of Stock</span>
                        </div>
                        {% endif %}
                    </div>
                    
                    <!-- Product Info -->
                    <div class="w-2/3 p-4">
                        <span class="text-xs text-[var(--accent)] font-medium mb-1 block">New Arrival</span>
                        <h3 class="font-medium mb-2 line-clamp-1">{{ product.name }}</h3>
                        <div class="flex items-end gap-2 mb-3">
                            <span class="font-bold text-[var(--primary)]">${{ product.price }}</span>
                            {% if product.cut_price %}
                                <span class="text-sm text-gray-400 line-through">${{ product.cut_price }}</span>
                            {% endif %}
                        </div>
                        
                        <div class="flex items-center gap-2">
                            <a href="{% url 'products:product_detail' subdomain=vendor.subdomain.subdomain slug=product.slug %}"
                               class="text-sm text-[var(--primary)] hover:underline">
                                View Details
                            </a>
                            <span class="text-gray-300">|</span>
                            <button onclick="toggleWishlist({{ product.id }});"
                                    class="text-sm text-gray-500 hover:text-[var(--primary)] transition-colors flex items-center gap-1">
                                <i class="{% if product.id in wishlisted_products %}fas text-red-500{% else %}far{% endif %} fa-heart"></i>
                                <span>Wishlist</span>
                            </button>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
    </div>
</section>

<!-- Enhanced Featured Products Carousel -->
<section id="featured-carousel" class="py-20 bg-gray-50">
    <div class="container mx-auto px-6">
        <!-- Section Header with Modern Design -->
        <div class="flex flex-col items-center mb-16 animate-on-scroll">
            <span class="px-4 py-1.5 bg-[var(--primary)]/10 text-[var(--primary)] rounded-full text-sm font-medium mb-4">
                Top Picks For You
            </span>
            <h2 class="text-4xl font-bold text-center relative">
                Featured Products
                <span class="absolute -bottom-3 left-1/2 transform -translate-x-1/2 w-24 h-1.5 bg-[var(--accent)] rounded-full"></span>
            </h2>
        </div>
        
        <!-- Products Carousel with Enhanced Controls -->
        <div class="relative">
            <!-- Carousel Controls -->
            <button id="prev-featured" class="absolute left-0 top-1/2 transform -translate-y-1/2 -translate-x-4 z-10 
                        w-10 h-10 rounded-full bg-white shadow-lg text-gray-700 flex items-center justify-center
                        hover:bg-[var(--primary)] hover:text-white transition-colors duration-300">
                <i class="fas fa-chevron-left"></i>
            </button>
            
            <button id="next-featured" class="absolute right-0 top-1/2 transform -translate-y-1/2 translate-x-4 z-10 
                        w-10 h-10 rounded-full bg-white shadow-lg text-gray-700 flex items-center justify-center
                        hover:bg-[var(--primary)] hover:text-white transition-colors duration-300">
                <i class="fas fa-chevron-right"></i>
            </button>
            
            <!-- Carousel Wrapper with Smooth Scrolling -->
            <div class="overflow-hidden">
                <div id="featured-carousel-items" class="flex transition-transform duration-500 ease-in-out space-x-6">
                    {% for product in products %}
                    <div class="flex-shrink-0 w-[280px] bg-white rounded-xl shadow-sm overflow-hidden 
                                {% if product.stock <= 0 %}opacity-80{% endif %}">
                        <a href="{% if product.stock > 0 %}{% url 'products:product_detail' subdomain=vendor.subdomain.subdomain slug=product.slug %}{% else %}javascript:void(0){% endif %}"
                           {% if product.stock <= 0 %}onclick="showNotification('This item is currently out of stock', 'error'); return false;"{% endif %}
                           class="{% if product.stock <= 0 %}cursor-not-allowed{% endif %}">
                            <div class="relative aspect-[4/3] overflow-hidden">
                                {% if product.product_images.first %}
                                    <img src="{{ product.product_images.first.image.url }}" 
                                         class="w-full h-full object-cover transition duration-700 {% if product.stock > 0 %}hover:scale-110{% endif %}">
                                {% endif %}
                                
                                <!-- Sale Badge -->
                                {% if product.cut_price %}
                                    <div class="absolute top-3 left-3 bg-red-500 text-white px-3 py-1 rounded-full text-xs font-medium">
                                        {{ product.discount_percentage|floatformat:0 }}% OFF
                                    </div>
                                {% endif %}
                                
                                <!-- Stock Status Badge -->
                                {% if product.stock <= 0 %}
                                    <div class="absolute inset-0 bg-black bg-opacity-60 flex items-center justify-center">
                                        <span class="bg-red-500 text-white px-4 py-2 rounded-full font-bold text-sm">
                                            Out of Stock
                                        </span>
                                    </div>
                                {% elif product.stock <= 5 %}
                                    <div class="absolute top-3 right-3">
                                        <span class="bg-amber-500 text-white text-xs px-3 py-1 rounded-full">
                                            Only {{ product.stock }} left
                                        </span>
                                    </div>
                                {% endif %}
                                
                                <!-- Wishlist Button (Absolute Positioned) -->
                                <button type="button" onclick="toggleWishlist({{ product.id }}); event.preventDefault();" 
                                        class="absolute bottom-3 right-3 w-10 h-10 bg-white/80 rounded-full shadow-md
                                        flex items-center justify-center transition-all hover:bg-white
                                        hover:scale-110 wishlist-btn"
                                        data-product-id="{{ product.id }}">
                                    <i class="{% if product.id in wishlisted_products %}fas text-red-500{% else %}far{% endif %} fa-heart"></i>
                                </button>
                            </div>
                        </a>
                        
                        <div class="p-5">
                            <!-- Product Title -->
                            <h3 class="font-medium text-lg line-clamp-1">{{ product.name }}</h3>
                            
                            <!-- Ratings -->
                            <div class="flex items-center mt-2 mb-3">
                                {% with avg_rating=product.average_rating %}
                                <div class="flex text-amber-400">
                                    {% for i in "12345" %}
                                        {% if forloop.counter <= avg_rating|floatformat:0 %}
                                            <i class="fas fa-star"></i>
                                        {% elif forloop.counter <= avg_rating|add:0.5|floatformat:0 %}
                                            <i class="fas fa-star-half-alt"></i>
                                        {% else %}
                                            <i class="far fa-star"></i>
                                        {% endif %}
                                    {% endfor %}
                                </div>
                                <span class="text-xs text-gray-500 ml-2">({{ product.review_count }})</span>
                                {% endwith %}
                            </div>
                            
                            <!-- Price -->
                            <div class="flex items-center space-x-2 mt-2">
                                <span class="text-xl font-bold text-[var(--primary)]">${{ product.price }}</span>
                                {% if product.cut_price %}
                                    <span class="text-sm text-gray-500 line-through">${{ product.cut_price }}</span>
                                {% endif %}
                            </div>
                            
                            <!-- Add to Cart Button -->
                            <button 
                                {% if product.stock <= 0 %}
                                    disabled
                                    onclick="showNotification('Sorry, {{ product.name }} is currently out of stock', 'error')"
                                    class="w-full mt-4 bg-gray-300 text-gray-600 py-2.5 px-4 rounded-lg cursor-not-allowed"
                                {% else %}
                                    onclick="addToCart({{ product.id }}, '{{ product.name }}')"
                                    class="w-full mt-4 bg-[var(--primary)] text-white py-2.5 px-4 rounded-lg
                                          transition-all duration-300 hover:shadow-lg hover:bg-[var(--primary)]/90 
                                          flex items-center justify-center space-x-2"
                                {% endif %}
                                data-product-id="{{ product.id }}"
                                data-stock="{{ product.stock }}">
                                {% if product.stock > 0 %}
                                    <i class="fas fa-shopping-cart"></i>
                                    <span>Add to Cart</span>
                                {% else %}
                                    <i class="fas fa-times-circle"></i>
                                    <span>Out of Stock</span>
                                {% endif %}
                            </button>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>
        
        <!-- View All Products Button -->
        <div class="mt-12 text-center animate-on-scroll">
            <a href="{% url 'products:product_list' subdomain=vendor.subdomain %}" 
               class="inline-flex items-center px-6 py-3 bg-[var(--primary)] text-white rounded-lg
                     hover:bg-[var(--primary)]/90 transition-all duration-300 hover:shadow-lg">
                <span>Browse All Products</span>
                <svg class="ml-2 w-5 h-5 transition-transform group-hover:translate-x-1" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3" />
                </svg>
            </a>
        </div>
    </div>
</section>

<!-- Featured Collections Section -->
<section class="py-20 bg-white">
    <div class="container mx-auto px-6">
        <div class="text-center mb-14 relative animate-on-scroll">
            <span class="inline-block text-[var(--accent)] font-semibold text-sm uppercase tracking-wider mb-2">Featured</span>
            <h2 class="text-4xl font-bold relative inline-block">
                Shop Our Collections
                <span class="absolute -bottom-3 left-1/2 transform -translate-x-1/2 w-24 h-1.5 bg-[var(--primary)]"></span>
            </h2>
        </div>
        
        <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
            <!-- Collection 1: New Arrivals -->
            <a href="{% url 'products:product_list' subdomain=vendor.subdomain %}?collection=new_arrivals" 
               class="relative h-96 rounded-xl overflow-hidden group collection-card">
                <div class="absolute inset-0 bg-black/40 group-hover:bg-black/50 transition-colors duration-300"></div>
                {% if vendor.settings.collection_images.all %}
                    {% for collection in vendor.settings.collection_images.all %}
                        {% if collection.collection_type == 'new_arrivals' %}
                            <img src="{{ collection.image.url }}" 
                                 alt="New Arrivals" class="w-full h-full object-cover transform group-hover:scale-110 transition-transform duration-700">
                            <div class="absolute inset-0 flex flex-col items-center justify-center text-white">
                                <h3 class="text-3xl font-bold mb-2">{{ collection.title }}</h3>
                                <p class="text-white/80 mb-4">{{ collection.subtitle }}</p>
                                <span class="px-6 py-2 bg-white/20 backdrop-blur-sm border border-white/30 rounded-lg group-hover:bg-white/30 transition-colors">
                                    Explore Collection
                                </span>
                            </div>
                        {% endif %}
                    {% endfor %}
                {% else %}
                    <img src="https://images.unsplash.com/photo-1490481651871-ab68de25d43d?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80" 
                         alt="New Arrivals" class="w-full h-full object-cover transform group-hover:scale-110 transition-transform duration-700">
                    <div class="absolute inset-0 flex flex-col items-center justify-center text-white">
                        <h3 class="text-3xl font-bold mb-2">New Arrivals</h3>
                        <p class="text-white/80 mb-4">Latest styles for you</p>
                        <span class="px-6 py-2 bg-white/20 backdrop-blur-sm border border-white/30 rounded-lg group-hover:bg-white/30 transition-colors">
                            Explore Collection
                        </span>
                    </div>
                {% endif %}
            </a>
            
            <!-- Collection 2: Best Sellers -->
            <a href="{% url 'products:product_list' subdomain=vendor.subdomain %}?collection=best_sellers"
                class="relative h-96 rounded-xl overflow-hidden group collection-card">
                <div class="absolute inset-0 bg-black/40 group-hover:bg-black/50 transition-colors duration-300"></div>
                {% if vendor.settings.collection_images.all %}
                    {% for collection in vendor.settings.collection_images.all %}
                        {% if collection.collection_type == 'best_sellers' %}
                            <img src="{{ collection.image.url }}" 
                                 alt="Best Sellers" class="w-full h-full object-cover transform group-hover:scale-110 transition-transform duration-700">
                            <div class="absolute inset-0 flex flex-col items-center justify-center text-white">
                                <h3 class="text-3xl font-bold mb-2">{{ collection.title }}</h3>
                                <p class="text-white/80 mb-4">{{ collection.subtitle }}</p>
                                <span class="px-6 py-2 bg-white/20 backdrop-blur-sm border border-white/30 rounded-lg group-hover:bg-white/30 transition-colors">
                                    Explore Collection
                                </span>
                            </div>
                        {% endif %}
                    {% endfor %}
                {% else %}
                    <img src="https://images.unsplash.com/photo-1469334031218-e382a71b716b?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80" 
                        alt="Best Sellers" class="w-full h-full object-cover transform group-hover:scale-110 transition-transform duration-700">
                    <div class="absolute inset-0 flex flex-col items-center justify-center text-white">
                        <h3 class="text-3xl font-bold mb-2">Best Sellers</h3>
                        <p class="text-white/80 mb-4">Customer favorites</p>
                        <span class="px-6 py-2 bg-white/20 backdrop-blur-sm border border-white/30 rounded-lg group-hover:bg-white/30 transition-colors">
                            Explore Collection
                        </span>
                    </div>
                {% endif %}
            </a>
            
            <!-- Collection 3: Season Special -->
            <a href="{% url 'products:product_list' subdomain=vendor.subdomain %}?collection=season_special" 
               class="relative h-96 rounded-xl overflow-hidden group collection-card">
                <div class="absolute inset-0 bg-black/40 group-hover:bg-black/50 transition-colors duration-300"></div>
                {% if vendor.settings.collection_images.all %}
                    {% for collection in vendor.settings.collection_images.all %}
                        {% if collection.collection_type == 'season_special' %}
                            <img src="{{ collection.image.url }}" 
                                 alt="Season Special" class="w-full h-full object-cover transform group-hover:scale-110 transition-transform duration-700">
                            <div class="absolute inset-0 flex flex-col items-center justify-center text-white">
                                <h3 class="text-3xl font-bold mb-2">{{ collection.title }}</h3>
                                <p class="text-white/80 mb-4">{{ collection.subtitle }}</p>
                                <span class="px-6 py-2 bg-white/20 backdrop-blur-sm border border-white/30 rounded-lg group-hover:bg-white/30 transition-colors">
                                    Explore Collection
                                </span>
                            </div>
                        {% endif %}
                    {% endfor %}
                {% else %}
                    <img src="https://images.unsplash.com/photo-1445205170230-053b83016050?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80" 
                         alt="Season Special" class="w-full h-full object-cover transform group-hover:scale-110 transition-transform duration-700">
                    <div class="absolute inset-0 flex flex-col items-center justify-center text-white">
                        <h3 class="text-3xl font-bold mb-2">Season Special</h3>
                        <p class="text-white/80 mb-4">Perfect for this season</p>
                        <span class="px-6 py-2 bg-white/20 backdrop-blur-sm border border-white/30 rounded-lg group-hover:bg-white/30 transition-colors">
                            Explore Collection
                        </span>
                    </div>
                {% endif %}
            </a>
        </div>
        
        <!-- Browse All Collections Button -->
        <div class="text-center mt-12">
            <a href="{% url 'products:product_list' subdomain=vendor.subdomain %}" 
               class="inline-flex items-center gap-3 px-8 py-3 border-2 border-[var(--primary)] text-[var(--primary)] rounded-lg hover:bg-[var(--primary)] hover:text-white transition-all">
                <span>Browse All Collections</span>
                <i class="fas fa-arrow-right"></i>
            </a>
        </div>
    </div>
</section>



<!-- Why Shop With Us Section -->
<section class="py-20 bg-gray-50 overflow-hidden relative">
    <!-- Background Decoration -->
    <div class="absolute inset-0 overflow-hidden pointer-events-none">
        <div class="absolute top-1/4 left-1/4 w-40 h-40 rounded-full border-4 border-[var(--primary)]/10 animate-float-slow"></div>
        <div class="absolute bottom-1/3 right-1/5 w-56 h-56 rounded-full border border-[var(--accent)]/10 animate-float-medium" style="animation-delay: 2s"></div>
    </div>

    <div class="container mx-auto px-6 relative z-10">
        <!-- Section Header -->
        <div class="flex flex-col items-center mb-16 animate-on-scroll">
            <span class="px-4 py-1.5 bg-[var(--primary)]/10 text-[var(--primary)] rounded-full text-sm font-medium mb-4">
                Why Shop With Us
            </span>
            <h2 class="text-4xl font-bold text-center relative">
                The {{ vendor.settings.store_name }} Experience
                <span class="absolute -bottom-3 left-1/2 transform -translate-x-1/2 w-24 h-1.5 bg-[var(--accent)] rounded-full"></span>
            </h2>
        </div>
        
        <!-- Feature Cards -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
            <!-- Free Shipping -->
            <div class="bg-white p-8 rounded-xl shadow-sm hover:shadow-md transition-all duration-300 animate-on-scroll"
                 style="animation-delay: 100ms">
                <div class="w-16 h-16 rounded-full bg-[var(--primary)]/10 flex items-center justify-center mb-6">
                    <i class="fas fa-truck text-[var(--primary)] text-2xl"></i>
                </div>
                <h3 class="text-xl font-bold mb-3">Free Fast Shipping</h3>
                <p class="text-gray-600">Enjoy free shipping on all orders above $50. Quick delivery right to your doorstep.</p>
            </div>
            
            <!-- Premium Quality -->
            <div class="bg-white p-8 rounded-xl shadow-sm hover:shadow-md transition-all duration-300 animate-on-scroll"
                 style="animation-delay: 200ms">
                <div class="w-16 h-16 rounded-full bg-[var(--primary)]/10 flex items-center justify-center mb-6">
                    <i class="fas fa-medal text-[var(--primary)] text-2xl"></i>
                </div>
                <h3 class="text-xl font-bold mb-3">Premium Quality</h3>
                <p class="text-gray-600">All our products undergo rigorous quality checks to ensure superior quality and durability.</p>
            </div>
            
            <!-- Easy Returns -->
            <div class="bg-white p-8 rounded-xl shadow-sm hover:shadow-md transition-all duration-300 animate-on-scroll"
                 style="animation-delay: 300ms">
                <div class="w-16 h-16 rounded-full bg-[var(--primary)]/10 flex items-center justify-center mb-6">
                    <i class="fas fa-undo text-[var(--primary)] text-2xl"></i>
                </div>
                <h3 class="text-xl font-bold mb-3">Easy Returns</h3>
                <p class="text-gray-600">Not satisfied? Return within 30 days for a full refund or exchange with our hassle-free policy.</p>
            </div>
            
            <!-- Secure Payment -->
            <div class="bg-white p-8 rounded-xl shadow-sm hover:shadow-md transition-all duration-300 animate-on-scroll"
                 style="animation-delay: 400ms">
                <div class="w-16 h-16 rounded-full bg-[var(--primary)]/10 flex items-center justify-center mb-6">
                    <i class="fas fa-lock text-[var(--primary)] text-2xl"></i>
                </div>
                <h3 class="text-xl font-bold mb-3">Secure Payment</h3>
                <p class="text-gray-600">Shop with confidence using our secure payment methods, with end-to-end encryption.</p>
            </div>
            
            <!-- Expert Support -->
            <div class="bg-white p-8 rounded-xl shadow-sm hover:shadow-md transition-all duration-300 animate-on-scroll"
                 style="animation-delay: 500ms">
                <div class="w-16 h-16 rounded-full bg-[var(--primary)]/10 flex items-center justify-center mb-6">
                    <i class="fas fa-headset text-[var(--primary)] text-2xl"></i>
                </div>
                <h3 class="text-xl font-bold mb-3">24/7 Support</h3>
                <p class="text-gray-600">Our dedicated support team is always ready to help you with any questions or concerns.</p>
            </div>
            
            <!-- Exclusive Deals -->
            <div class="bg-white p-8 rounded-xl shadow-sm hover:shadow-md transition-all duration-300 animate-on-scroll"
                 style="animation-delay: 600ms">
                <div class="w-16 h-16 rounded-full bg-[var(--primary)]/10 flex items-center justify-center mb-6">
                    <i class="fas fa-gift text-[var(--primary)] text-2xl"></i>
                </div>
                <h3 class="text-xl font-bold mb-3">Exclusive Offers</h3>
                <p class="text-gray-600">Subscribe to our newsletter for exclusive deals and early access to new arrivals.</p>
            </div>
        </div>
        
        <!-- Call to Action -->
        <div class="text-center mt-12">
            <a href="{% url 'products:product_list' subdomain=vendor.subdomain %}" 
               class="inline-flex items-center gap-3 px-8 py-3.5 bg-[var(--primary)] text-white rounded-lg hover:bg-opacity-90 transition-all shadow-lg hover:shadow-[var(--primary)]/20">
                <span>Browse Products</span>
                <i class="fas fa-arrow-right"></i>
            </a>
        </div>
    </div>
</section>


<!-- Enhanced Instagram Gallery with 4 Posts -->
<section class="py-20 bg-gradient-to-b from-white to-gray-50 relative overflow-hidden">
    <!-- Decorative elements for aesthetic appeal -->
    <div class="absolute top-0 left-0 w-full h-20 bg-gradient-to-b from-white to-transparent z-10"></div>
    <div class="absolute -top-32 -right-32 w-64 h-64 bg-[var(--accent)]/5 rounded-full"></div>
    <div class="absolute -bottom-40 -left-40 w-80 h-80 bg-[var(--primary)]/5 rounded-full"></div>
    
    <div class="container mx-auto px-6 relative z-20">
        <!-- Section Header with Animation -->
        <div class="text-center mb-12 animate-on-scroll">
            <div class="inline-flex items-center mb-2 px-4 py-1.5 bg-[var(--accent)]/10 text-[var(--accent)] rounded-full text-sm font-medium">
                <i class="fab fa-instagram mr-2"></i> Instagram
            </div>
            <h2 class="text-4xl font-bold mb-4 relative inline-block">
                Follow Our Journey
                <span class="absolute -bottom-2 left-0 w-full h-1 bg-gradient-to-r from-[var(--accent)] to-[var(--primary)]"></span>
            </h2>
            {% if vendor.settings.instagram %}
                <p class="text-gray-600 max-w-2xl mx-auto mt-4">
                    Follow <a href="{{ vendor.settings.instagram }}" 
                       class="font-medium text-[var(--primary)] hover:underline">@{{ vendor.settings.instagram|slice:"19:" }}</a> 
                    for inspiration, behind-the-scenes moments, and exclusive offers.
                </p>
            {% else %}
                <p class="text-gray-600 max-w-2xl mx-auto mt-4">
                    Follow us on Instagram for inspiration, behind-the-scenes moments, and exclusive offers.
                </p>
            {% endif %}
        </div>
        
        <!-- Instagram Feed with 4 Posts -->
        <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
            {% if instagram_posts %}
                {% for post in instagram_posts|slice:":4" %}
                <a href="{{ post.permalink|default:post.link }}" target="_blank" rel="noopener noreferrer"
                   class="block group aspect-square overflow-hidden rounded-xl animate-on-scroll"
                   style="animation-delay: {% cycle '0ms' '150ms' '300ms' '450ms' %}">
                    <div class="relative h-full transform transition-all duration-500 group-hover:scale-105">
                        <img src="{{ post.media_url|default:post.image_url }}" alt="Instagram Post" 
                             class="w-full h-full object-cover">
                        <div class="absolute inset-0 bg-gradient-to-t from-black/70 via-black/40 to-transparent opacity-0 group-hover:opacity-100 transition-all duration-300 flex flex-col justify-end p-3">
                            <div class="text-white">
                                <div class="flex items-center space-x-2 mb-2">
                                    <i class="fab fa-instagram"></i>
                                    <span>@{{ vendor.settings.instagram|slice:"19:"|default:"yourstore" }}</span>
                                </div>
                                {% if post.caption %}
                                <p class="text-xs line-clamp-2 text-white/80">{{ post.caption|truncatechars:60 }}</p>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </a>
                {% empty %}
                <!-- Fallback message when no posts are available -->
                <div class="col-span-full text-center py-10">
                    <div class="text-gray-500 mb-4">
                        <i class="fab fa-instagram text-4xl"></i>
                    </div>
                    <h3 class="text-xl font-medium mb-2">No Instagram Posts Available</h3>
                    <p class="text-gray-500 max-w-md mx-auto">
                        Connect your Instagram account to display your latest posts here.
                    </p>
                </div>
                {% endfor %}
            {% else %}
                <!-- Loading state for Instagram posts -->
                <div class="col-span-full text-center py-10">
                    <div class="inline-block animate-pulse">
                        <i class="fab fa-instagram text-gray-300 text-4xl"></i>
                    </div>
                    <h3 class="text-xl font-medium mt-4 mb-2">Loading Instagram Feed</h3>
                    <p class="text-gray-500">
                        Please wait while we fetch your latest posts...
                    </p>
                </div>
            {% endif %}
        </div>
        
        <!-- Instagram Follow Button -->
        <div class="text-center mt-10 animate-on-scroll">
            <a href="{{ vendor.settings.instagram|default:'https://instagram.com' }}" 
               target="_blank" rel="noopener noreferrer"
               class="inline-flex items-center px-6 py-3 bg-gradient-to-r from-purple-500 to-pink-500 text-white rounded-lg
                     hover:from-purple-600 hover:to-pink-600 transition-all duration-300 group">
                <i class="fab fa-instagram mr-2"></i>
                <span>Follow on Instagram</span>
                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 ml-2 transition-transform duration-300 group-hover:translate-x-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3" />
                </svg>
            </a>
        </div>
    </div>
</section>



<!-- Notification Toast Container -->
<div id="notification-container" class="fixed top-6 right-6 z-50"></div>

<!-- Back to Top Button -->
<button id="back-to-top" class="fixed bottom-6 right-6 w-12 h-12 bg-[var(--primary)] text-white rounded-full shadow-lg 
                              flex items-center justify-center transform translate-y-20 opacity-0 transition-all duration-500 z-30">
    <i class="fas fa-arrow-up"></i>
</button>





<!-- Enhanced JavaScript for Animations and Functionality -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    // ===== HERO SLIDER WITH IMPROVED TRANSITIONS =====
    const covers = document.querySelectorAll('[data-cover]');
    const indicators = document.querySelectorAll('[data-slide]');
    let currentSlide = 0;
    let slideInterval;
    let isAnimating = false;
    
    function startSlideShow() {
        slideInterval = setInterval(nextSlide, 5000);
    }
    
    function nextSlide() {
        if (isAnimating) return;
        isAnimating = true;
        goToSlide((currentSlide + 1) % covers.length);
        setTimeout(() => { isAnimating = false; }, 1000);
    }
    
    function goToSlide(index) {
        // Hide all slides
        covers.forEach(cover => {
            cover.classList.remove('opacity-100');
            cover.classList.add('opacity-0');
        });
        
        // Update indicators
        indicators.forEach(indicator => {
            indicator.classList.remove('bg-white', 'w-10');
            indicator.classList.add('bg-white/40');
        });
        
        // Show selected slide
        covers[index].classList.add('opacity-100');
        covers[index].classList.remove('opacity-0');
        
        // Update indicator
        if (indicators[index]) {
            indicators[index].classList.add('bg-white', 'w-10');
            indicators[index].classList.remove('bg-white/40');
        }
        
        currentSlide = index;
    }
    
    // Attach handlers
    if (indicators.length > 0) {
        indicators.forEach((indicator, index) => {
            indicator.addEventListener('click', () => {
                if (isAnimating) return;
                isAnimating = true;
                clearInterval(slideInterval);
                goToSlide(index);
                startSlideShow();
                setTimeout(() => { isAnimating = false; }, 1000);
            });
        });
        
        startSlideShow();
    }
    
    // ===== PARALLAX EFFECT FOR COLLECTIONS =====
    const parallaxItems = document.querySelectorAll('.collection-parallax');
    
    function handleParallax() {
        parallaxItems.forEach(item => {
            const rect = item.getBoundingClientRect();
            const isVisible = (rect.top <= window.innerHeight && rect.bottom >= 0);
            
            if (isVisible) {
                const scrolled = window.scrollY;
                const bg = item.querySelector('.parallax-bg');
                const content = item.querySelector('.collection-content');
                
                // Parallax effect for background
                const speed = 0.15;
                const yPos = -(rect.top * speed);
                if (bg) bg.style.transform = `translate3d(0, ${yPos}px, 0) scale(1.1)`;
                
                // Fade in content when visible
                if (content && rect.top < window.innerHeight * 0.8) {
                    content.style.transform = 'translateY(0)';
                    content.style.opacity = '1';
                } else if (content) {
                    content.style.transform = 'translateY(6px)';
                    content.style.opacity = '0';
                }
            }
        });
    }
    
    // ===== FEATURED CAROUSEL =====
    const carousel = document.getElementById('featured-carousel-items');
    const prevBtn = document.getElementById('prev-featured');
    const nextBtn = document.getElementById('next-featured');
    let scrollAmount = 0;
    const cardWidth = 280 + 24; // card width + gap
    
    if (carousel && prevBtn && nextBtn) {
        prevBtn.addEventListener('click', () => {
            scrollAmount = Math.max(scrollAmount - cardWidth * 2, 0);
            carousel.style.transform = `translateX(-${scrollAmount}px)`;
            updateCarouselButtons();
        });
        
        nextBtn.addEventListener('click', () => {
            const maxScroll = carousel.scrollWidth - carousel.clientWidth;
            scrollAmount = Math.min(scrollAmount + cardWidth * 2, maxScroll);
            carousel.style.transform = `translateX(-${scrollAmount}px)`;
            updateCarouselButtons();
        });
        
        function updateCarouselButtons() {
            prevBtn.disabled = scrollAmount <= 0;
            nextBtn.disabled = scrollAmount >= carousel.scrollWidth - carousel.clientWidth;
            
            prevBtn.style.opacity = prevBtn.disabled ? '0.5' : '1';
            nextBtn.style.opacity = nextBtn.disabled ? '0.5' : '1';
        }
        
        // Initial update
        updateCarouselButtons();
        
        // Update on window resize
        window.addEventListener('resize', updateCarouselButtons);
    }
    
    
    // ===== SCROLL ANIMATIONS =====
    const animatedElements = document.querySelectorAll('.animate-on-scroll');
    
    const observer = new IntersectionObserver(
        (entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('animate-in');
                    observer.unobserve(entry.target);
                }
            });
        },
        { threshold: 0.1 }
    );
    
    animatedElements.forEach(el => observer.observe(el));
    
    // ===== STAGGERED ANIMATIONS =====
    const staggerContainers = document.querySelectorAll('.stagger-children');
    
    const staggerObserver = new IntersectionObserver(
        (entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('animate-in');
                    staggerObserver.unobserve(entry.target);
                }
            });
        },
        { threshold: 0.1 }
    );
    
    staggerContainers.forEach(container => staggerObserver.observe(container));
    
    // ===== BACK TO TOP BUTTON =====
    const backToTopBtn = document.getElementById('back-to-top');
    
    if (backToTopBtn) {
        window.addEventListener('scroll', () => {
            if (window.scrollY > 500) {
                backToTopBtn.classList.add('opacity-100');
                backToTopBtn.classList.remove('opacity-0', 'translate-y-20');
            } else {
                backToTopBtn.classList.remove('opacity-100');
                backToTopBtn.classList.add('opacity-0', 'translate-y-20');
            }
        });
        
        backToTopBtn.addEventListener('click', () => {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        });
    }
    
    // ===== ENHANCED NOTIFICATION SYSTEM =====
    function showNotification(message, type = 'success') {
        const container = document.getElementById('notification-container');
        const notification = document.createElement('div');
        
        notification.className = `notification flex items-center p-4 mb-4 rounded-lg shadow-lg transform transition-all duration-300 
                                  ${type === 'success' ? 'bg-green-100 text-green-800 border-l-4 border-green-500' : 
                                  type === 'error' ? 'bg-red-100 text-red-800 border-l-4 border-red-500' :
                                  'bg-blue-100 text-blue-800 border-l-4 border-blue-500'}`;
        
        notification.innerHTML = `
            <div class="flex items-center">
                <div class="flex-shrink-0">
                    <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : 'info-circle'} 
                          text-${type === 'success' ? 'green' : type === 'error' ? 'red' : 'blue'}-600"></i>
                </div>
                <div class="ml-3">
                    <p class="text-sm font-medium">${message}</p>
                </div>
                <div class="ml-auto pl-3">
                    <button class="inline-flex text-gray-400 hover:text-gray-500 focus:outline-none" onclick="this.parentElement.parentElement.parentElement.remove()">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>
        `;
        
        container.appendChild(notification);
        
        // Animate in
        setTimeout(() => {
            notification.classList.add('translate-y-0');
        }, 10);
        
        // Auto remove after 5 seconds
        setTimeout(() => {
            notification.classList.add('opacity-0', '-translate-y-3');
            setTimeout(() => {
                notification.remove();
            }, 300);
        }, 5000);
    }
    
    // Make showNotification available globally
    window.showNotification = showNotification;
    
    // ===== STOCK MANAGEMENT & CART FUNCTIONALITY =====
    window.addToCart = function(productId, productName) {
        // Check if product is in stock
        const button = document.querySelector(`button[data-product-id="${productId}"]`);
        const stock = parseInt(button.dataset.stock);
        
        if (stock <= 0) {
            showNotification(`Sorry, this item is currently out of stock`, 'error');
            return;
        }
        
        // Add to cart AJAX request
        fetch('{% url "products:add_to_cart" %}', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'X-CSRFToken': getCookie('csrftoken')
            },
            body: JSON.stringify({
                product_id: productId,
                quantity: 1
            })
        })
        .then(response => response.json())
        .then(data => {
            if (data.status === 'success') {
                showNotification(`Item added to cart!`, 'success');
                updateCartCount(data.cart_count || (parseInt(document.querySelector('.cart-count').innerText || '0') + 1));
                
                // Animate the button
                button.classList.add('animate-success');
                setTimeout(() => {
                    button.classList.remove('animate-success');
                }, 1000);
            } else {
                showNotification(data.message || 'Failed to add item to cart', 'error');
            }
        })
        .catch(error => {
            console.error('Error:', error);
            showNotification('An error occurred. Please try again.', 'error');
        });
    }

    window.toggleWishlist = function(productId) {
        const wishlistBtns = document.querySelectorAll(`.wishlist-btn[data-product-id="${productId}"]`);
        
        fetch('{% url "products:toggle_wishlist" %}', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'X-CSRFToken': getCookie('csrftoken')
            },
            body: JSON.stringify({ product_id: productId })
        })
        .then(response => {
            if (response.status === 401) {
                // User is not logged in, redirect to login page
                window.location.href = "{% url 'accounts:customer_login' subdomain=vendor.subdomain %}";
                throw new Error('Not authenticated');
            }
            return response.json();
        })
        .then(data => {
            if (data.status === 'success') {
                wishlistBtns.forEach(btn => {
                    const icon = btn.querySelector('i');
                    if (icon) {
                        if (data.added) {
                            icon.classList.remove('far');
                            icon.classList.add('fas', 'text-red-500');
                        } else {
                            icon.classList.remove('fas', 'text-red-500');
                            icon.classList.add('far');
                        }
                    }
                });
    
                updateWishlistCount(data.wishlist_count);
                
                showNotification(data.message);
            } else {
                showNotification(data.message || 'Failed to update wishlist', 'error');
            }
        })
        .catch(error => {
            if (error.message !== 'Not authenticated') {
                console.error('Error:', error);
                showNotification('An error occurred. Please try again.', 'error');
            }
        });
    };
    
    function updateWishlistCount(count) {
        const wishlistCountElements = document.querySelectorAll('.wishlist-count');
        wishlistCountElements.forEach(el => {
            el.textContent = count;
            if (count > 0) {
                el.classList.remove('hidden');
            } else {
                el.classList.add('hidden');
            }
        });
    }

    function updateCartCount(count) {
        const cartCountElements = document.querySelectorAll('.cart-count');
        cartCountElements.forEach(el => {
            el.textContent = count;
            if (count > 0) {
                el.classList.remove('hidden');
            }
        });
    }

    function getCookie(name) {
        const value = `; ${document.cookie}`;
        const parts = value.split(`; ${name}=`);
        if (parts.length === 2) return parts.pop().split(';').shift();
    }
    
    // Initial call for parallax
    handleParallax();
    window.addEventListener('scroll', handleParallax);
    window.addEventListener('resize', handleParallax);
});

</script>

<!-- Enhanced CSS Animations -->
<style>
    /* Enhanced animations */
    @keyframes fadeInUp {
        from {
            opacity: 0;
            transform: translateY(30px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }
    
    @keyframes fadeInRight {
        from {
            opacity: 0;
            transform: translateX(-30px);
        }
        to {
            opacity: 1;
            transform: translateX(0);
        }
    }
    
    @keyframes fadeInLeft {
        from {
            opacity: 0;
            transform: translateX(30px);
        }
        to {
            opacity: 1;
            transform: translateX(0);
        }
    }
    
    @keyframes float-slow {
        0%, 100% {
            transform: translateY(0);
        }
        50% {
            transform: translateY(-15px);
        }
    }
    
    @keyframes float-medium {
        0%, 100% {
            transform: translateY(0);
        }
        50% {
            transform: translateY(-10px);
        }
    }
    
    @keyframes float-fast {
        0%, 100% {
            transform: translateY(0);
        }
        50% {
            transform: translateY(-5px);
        }
    }
    
    @keyframes pulse-slow {
        0%, 100% {
            transform: scale(1);
            opacity: 0.7;
        }
        50% {
            transform: scale(1.05);
            opacity: 1;
        }
    }
    
    @keyframes ken-burns {
        0% {
            transform: scale(1);
        }
        50% {
            transform: scale(1.05);
        }
        100% {
            transform: scale(1);
        }
    }
    
    @keyframes animate-success {
        0%, 100% {
            transform: scale(1);
        }
        50% {
            transform: scale(1.05);
            background-color: #10b981;
        }
    }
    
    .animate-fade-up {
        opacity: 0;
        animation: fadeInUp 0.8s ease-out forwards;
    }
    
    .animate-fade-right {
        opacity: 0;
        animation: fadeInRight 0.8s ease-out forwards;
    }
    
    .animate-fade-left {
        opacity: 0;
        animation: fadeInLeft 0.8s ease-out forwards;
    }
    
    .animate-float-slow {
        animation: float-slow 6s ease-in-out infinite;
    }
    
    .animate-float-medium {
        animation: float-medium 5s ease-in-out infinite;
    }
    
    .animate-float-fast {
        animation: float-fast 4s ease-in-out infinite;
    }
    
    .animate-pulse-slow {
        animation: pulse-slow 3s ease-in-out infinite;
    }
    
    .animate-ken-burns {
        animation: ken-burns 15s ease-in-out infinite;
    }
    
    .animate-success {
        animation: animate-success 0.5s ease-in-out;
    }
    
    /* Scroll animations */
    .animate-on-scroll {
        opacity: 0;
        transform: translateY(30px);
        transition: opacity 0.8s ease-out, transform 0.8s ease-out;
    }
    
    .animate-on-scroll.animate-in {
        opacity: 1;
        transform: translateY(0);
    }
    
    /* Stagger children animations */
    .stagger-children > * {
        opacity: 0;
        transform: translateY(20px);
        transition: opacity 0.5s ease, transform 0.5s ease;
    }
    
    .stagger-children.animate-in > *:nth-child(1) { transition-delay: 0ms; }
    .stagger-children.animate-in > *:nth-child(2) { transition-delay: 100ms; }
    .stagger-children.animate-in > *:nth-child(3) { transition-delay: 200ms; }
    .stagger-children.animate-in > *:nth-child(4) { transition-delay: 300ms; }
    .stagger-children.animate-in > *:nth-child(5) { transition-delay: 400ms; }
    .stagger-children.animate-in > *:nth-child(6) { transition-delay: 500ms; }
    
    .stagger-children.animate-in > * {
        opacity: 1;
        transform: translateY(0);
    }
    
    /* Parallax container */
    .parallax-container {
        overflow: hidden;
    }
    
    .parallax-bg {
        transition: transform 0.3s ease-out;
    }
    
    .collection-content {
        transition: transform 0.7s ease-out, opacity 0.7s ease-out;
    }
</style>
{% endblock %}